import{P as M,A as E,h as C,o as g,i as N,j as $,c as k,r as q,b as e,a as b,k as S,t as d,F as D,u as l,q as v,l as L,w as V,e as T,d as I,v as x,f as j,g as A,a5 as O}from"./app-13978987.js";import{_ as P}from"./AdminLayout-bd13ff9d.js";import{l as R}from"./vue-draggable-plus-77a23e2f.js";import{_ as F}from"./PageHeader-8c638686.js";import"./dropdown-45d66330.js";const t=M({contents:[],contentId:null,isEdit:!1,newItem:{id:null,text:"",icon:"",href:"",permission:"",target:"_self",deletable:!0,children:[]},addNewItem(){if(this.newItem.text){this.newItem.id=Math.floor(Math.random()*Date.now()).toString(36);const n=JSON.parse(JSON.stringify(this.newItem));this.contents.push(n),this.resetItem()}},editItem(){this.isEdit=!0;const n=this.findItemById(this.contents,this.contentId);n&&(this.newItem={...n})},updateItem(){const n=this.findItemById(this.contents,this.newItem.id);n&&this.newItem.text&&(Object.assign(n,this.newItem),this.resetItem(),this.isEdit=!1)},removeItemById(n,c){for(let a=0;a<n.length;a++){if(n[a].id===c){n.splice(a,1);return}n[a].children&&n[a].children.length>0&&this.removeItemById(n[a].children,c)}},removeItem(){this.removeItemById(this.contents,this.contentId)},resetItem(){setTimeout(()=>{this.newItem={id:null,text:"",icon:"",href:"",permission:"",target:"_self",deletable:!0,children:[]}},500)},findItemById(n,c){for(const a of n){if(a.id===c)return a;if(a.children&&a.children.length>0){const s=this.findItemById(a.children,c);if(s)return s}}return null}}),J={class:"flex items-center justify-between rounded border p-2 dark:border-gray-600"},K={class:"cursor-move"},Y=["onClick"],z=["onClick"],G=1,H={__name:"NestedDraggableSidebar",props:{modelValue:{required:!0},level:{type:Number,default:0}},emits:["update:modelValue"],setup(n,{emit:c}){const a=n,s=c,o=E({get:()=>a.modelValue,set:u=>s("update:modelValue",u)}),_=(u,p)=>{if(!p.deletable)return v.danger("You can not delete this item");t.contentId=u,t.removeItem()},i=u=>{t.contentId=u,t.editItem()},U=u=>(u.to.dataset.level?parseInt(u.to.dataset.level):0)>G?(v.warning("Cannot move this item to the selected location due to nesting restrictions."),!1):!0,B=u=>{const p=u.data;if(p.children&&p.children.length>0){const h=Array.from(p.children),r=[];h.forEach(f=>{r.push(f),t.contentId=f.id,t.removeItem()}),r.forEach(f=>{t.contents.push(f)}),v.warning("Remaining links added at the end")}const y=h=>h.map(r=>(r.children?r.children=y(r.children):r.children=[],r)),m=h=>h.map(r=>(r.children&&(r.children=r.children.map(f=>(f.children&&delete f.children,f))),r));return t.contents=y(t.contents),t.contents=m(t.contents),!0};return(u,p)=>{const w=C("Icon"),y=C("NestedDraggableSidebar",!0);return g(),N(l(R),{class:"drag-area",tag:"ul",modelValue:o.value,"onUpdate:modelValue":p[0]||(p[0]=m=>o.value=m),group:"g1",onMove:U,onEnd:B,"data-level":n.level},{default:$(()=>[(g(!0),k(D,null,q(n.modelValue,m=>(g(),k("li",{key:m.id},[e("div",J,[e("p",K,[b(w,{class:"mb-px inline text-lg",icon:"tdesign:drag-move"}),S(" "+d(m.text),1)]),e("div",null,[e("button",{class:"btn p-1.5",onClick:h=>i(m.id)},[b(w,{class:"text-lg",icon:"fe:pencil"})],8,Y),e("button",{class:"btn p-1.5",onClick:h=>_(m.id,m)},[b(w,{class:"text-lg",icon:"fe:trash"})],8,z)])]),b(y,{modelValue:m.children,"onUpdate:modelValue":h=>m.children=h,level:n.level+1},null,8,["modelValue","onUpdate:modelValue","level"])]))),128))]),_:1},8,["modelValue","data-level"])}}},Q={class:"container p-4 sm:p-6"},W={class:"grid grid-cols-1 place-items-start gap-6 lg:grid-cols-12"},X={class:"card col-span-1 lg:col-span-8"},Z={class:"card-body"},ee={class:"mb-8 flex items-center justify-between"},te={class:"col-span-1 w-full lg:col-span-4"},ne={class:"card-body card"},se={class:"mb-5"},oe={class:"space-y-2"},le={for:"text",class:"label label-required mb-1"},ae={for:"text",class:"label label-required mb-1"},ie={for:"href",class:"label label-required mb-1"},de={for:"text",class:"label"},re={for:"target",class:"label label-required mb-1"},ce={value:"_self"},ue={value:"_blank"},me={value:"_top"},pe={class:"menu-add-update mt-6 flex"},he=["disabled"],fe=["disabled"],be=A({layout:P}),ye=Object.assign(be,{__name:"Show",props:["info","contents","segments","buttons","location"],setup(n){const c=n;L(()=>{t.contents=c.contents});const a=()=>{O.patch(route("admin.sidebar-menu.data.update",c.info.id),{data:t.contents,location:c.location}).then(s=>{s.status==200&&(v.success("Menu item has been updated successfully"),window.location.reload())}).catch(s=>{v.danger(s.response.data.error)})};return(s,o)=>{const _=C("Icon");return g(),k("main",Q,[b(F,{title:s.trans("Manage Sidebar Menu"),buttons:n.buttons},null,8,["title","buttons"]),e("div",W,[e("div",X,[e("div",Z,[e("div",ee,[e("h4",null,d(s.trans("Sidebar Items")),1),e("button",{type:"button",id:"form-button",class:"btn btn-success",onClick:V(a,["prevent"])},d(s.trans("Save")),1)]),e("div",null,[c.contents?(g(),N(H,{key:0,modelValue:l(t).contents,"onUpdate:modelValue":o[0]||(o[0]=i=>l(t).contents=i)},null,8,["modelValue"])):T("",!0)])])]),e("div",te,[e("div",ne,[e("h4",se,d(s.trans("Create Sidebar Items")),1),e("form",oe,[e("div",null,[e("label",le,d(s.trans("Text")),1),I(e("input",{type:"text",class:"input",name:"text",id:"text",placeholder:"Text",autocomplete:"off","onUpdate:modelValue":o[1]||(o[1]=i=>l(t).newItem.text=i)},null,512),[[x,l(t).newItem.text]])]),e("div",null,[e("label",ae,d(s.trans("Icon")),1),I(e("input",{type:"text",class:"input",placeholder:"Icon",required:"",autocomplete:"off","onUpdate:modelValue":o[2]||(o[2]=i=>l(t).newItem.icon=i)},null,512),[[x,l(t).newItem.icon]])]),e("div",null,[e("label",ie,d(s.trans("URL")),1),I(e("input",{type:"text",class:"input",id:"href",name:"href",placeholder:"URL",required:"",autocomplete:"off","onUpdate:modelValue":o[3]||(o[3]=i=>l(t).newItem.href=i)},null,512),[[x,l(t).newItem.href]])]),e("div",null,[e("label",de,d(s.trans("Permission")),1),I(e("input",{type:"text",class:"input",placeholder:"Permission",autocomplete:"off","onUpdate:modelValue":o[4]||(o[4]=i=>l(t).newItem.permission=i)},null,512),[[x,l(t).newItem.permission]])]),e("div",null,[e("label",re,d(s.trans("Target")),1),I(e("select",{name:"target",class:"input","onUpdate:modelValue":o[5]||(o[5]=i=>l(t).newItem.target=i)},[e("option",ce,d(s.trans("Self")),1),e("option",ue,d(s.trans("Blank")),1),e("option",me,d(s.trans("Top")),1)],512),[[j,l(t).newItem.target]])])]),e("div",pe,[e("button",{type:"button",id:"btnUpdate",class:"btn btn-update btn-warning mr-2 flex-1 text-white",onClick:o[6]||(o[6]=V((...i)=>l(t).updateItem&&l(t).updateItem(...i),["prevent"])),disabled:!l(t).isEdit},[b(_,{icon:"bx:refresh",class:"text-lg"}),S(" "+d(s.trans("Update")),1)],8,he),e("button",{type:"button",id:"btnAdd",onClick:o[7]||(o[7]=V((...i)=>l(t).addNewItem&&l(t).addNewItem(...i),["prevent"])),class:"btn btn-success flex-1",disabled:l(t).isEdit},[b(_,{icon:"bx:plus",class:"text-lg"}),S(" "+d(s.trans("Add")),1)],8,fe)])])])])])}}});export{ye as default};
